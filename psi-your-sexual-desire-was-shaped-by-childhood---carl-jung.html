<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Your Sexual Desire Was Shaped by Childhood — Carl Jung — Infographic</title>
  <meta name="description" content="Interactive infographic exploring Carl Jung's theory that sexual desire patterns originate in childhood emotional experiences, attachment styles, and the unconscious shadow." />
  <style>
    :root{
      --bg: #0b0f17;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.085);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --faint: rgba(255,255,255,.55);
      --good: #75f0b6;
      --warn: #ffd27a;
      --bad: #ff7a99;
      --cyan: #7ad7ff;
      --violet: #bba7ff;
      --orange: #ffb38a;
      --shadow: 0 16px 60px rgba(0,0,0,.45);
      --shadow2: 0 10px 25px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --grid: rgba(255,255,255,.07);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(187,167,255,.10), transparent 60%),
        radial-gradient(900px 500px at 80% 15%, rgba(255,122,153,.08), transparent 55%),
        radial-gradient(800px 500px at 55% 85%, rgba(255,210,122,.06), transparent 60%),
        linear-gradient(180deg, #070a10, var(--bg));
      overflow-x:hidden;
    }

    a{color:inherit}

    .wrap{max-width:1220px;margin:0 auto;padding:34px 18px 70px}

    /* Header */
    header{
      position: relative;
      padding: 26px 18px 22px;
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .headerGrid{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 18px;
      align-items: start;
    }
    .kicker{
      display:inline-flex;align-items:center;gap:10px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.25);
      font-size: 12px;
      letter-spacing:.12em;
      text-transform: uppercase;
      color: var(--muted);
    }
    .kicker .dot{width:8px;height:8px;border-radius:99px;background: linear-gradient(90deg, var(--violet), var(--bad)); box-shadow: 0 0 22px rgba(187,167,255,.25)}

    h1{margin:14px 0 10px;font-size: clamp(26px, 3.1vw, 44px);line-height:1.04;letter-spacing:-0.02em}
    .subtitle{margin:0 0 14px;color:var(--muted);font-size: 15px;line-height:1.55;max-width:72ch}

    .topStats{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 12px;
      align-content: start;
    }
    .stat{
      border: 1px solid var(--stroke);
      border-radius: var(--radius2);
      background: rgba(0,0,0,.18);
      padding: 12px 12px 10px;
      box-shadow: var(--shadow2);
      min-height: 84px;
    }
    .stat .label{font-size:12px;color:var(--faint);text-transform:uppercase;letter-spacing:.12em}
    .stat .value{margin-top:7px;font-weight:700;font-size: 18px}
    .stat .note{margin-top:4px;font-size:12px;color:var(--muted)}

    .heroArt{
      position:absolute;inset:-1px -1px auto auto;
      width:min(520px, 55vw);
      height: 260px;
      pointer-events:none;
      opacity:.9;
      mask-image: radial-gradient(260px 200px at 65% 40%, rgba(0,0,0,1), rgba(0,0,0,.0) 70%);
    }

    /* Layout */
    .grid{
      margin-top: 18px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }

    .row{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 14px;
    }

    @media (max-width: 960px){
      .headerGrid{grid-template-columns: 1fr}
      .row{grid-template-columns: 1fr}
      .heroArt{height:160px}
    }

    /* Cards */
    .card{
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      background: rgba(255,255,255,.05);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .cardHeader{
      display:flex;justify-content:space-between;align-items:flex-start;gap: 12px;
      padding: 14px 16px 10px;
      border-bottom: 1px solid rgba(255,255,255,.09);
      background: linear-gradient(180deg, rgba(0,0,0,.18), transparent);
    }
    .cardHeader h2{margin:0;font-size: 16px;letter-spacing:-0.01em}
    .chip{
      display:inline-flex;align-items:center;gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.22);
      color: var(--muted);
      font-size: 12px;
      user-select:none;
      white-space:nowrap;
    }
    .chip b{color: var(--text)}
    .cardBody{padding: 14px 16px 16px}

    .muted{color:var(--muted)}
    .small{font-size:12px;color:var(--muted)}

    .split{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 740px){
      .split{grid-template-columns:1fr}
    }

    /* Pill & Tags */
    .pill{
      border: 1px solid rgba(255,255,255,.11);
      border-radius: 999px;
      padding: 10px 12px;
      background: rgba(0,0,0,.18);
      display:flex;align-items:center;justify-content:space-between;gap: 10px;
      min-height: 44px;
    }
    .pill span{font-size: 13px}
    .tag{
      font-size: 11px;
      letter-spacing:.08em;
      text-transform: uppercase;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      white-space:nowrap;
    }

    /* Diagram area */
    .viz{
      border: 1px solid rgba(255,255,255,.11);
      border-radius: var(--radius2);
      background:
        linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.08)),
        repeating-linear-gradient(90deg, transparent, transparent 22px, rgba(255,255,255,.03) 22px, rgba(255,255,255,.03) 23px),
        repeating-linear-gradient(0deg, transparent, transparent 22px, rgba(255,255,255,.03) 22px, rgba(255,255,255,.03) 23px);
      padding: 12px;
      position:relative;
      overflow:hidden;
    }

    svg{display:block;width:100%;height:auto}

    .controls{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    @media (max-width: 740px){
      .controls{grid-template-columns:1fr}
    }

    .control{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius: 14px;
      padding: 10px 12px;
    }
    .control label{display:flex;justify-content:space-between;gap:12px;align-items:center;font-size:12px;color:var(--muted);letter-spacing:.08em;text-transform:uppercase}
    input[type="range"]{width:100%;margin-top:10px;accent-color: var(--violet)}
    .control .readout{font-family:var(--mono);font-size:12px;color:var(--text)}

    .legend{
      display:flex;flex-wrap:wrap;gap:8px;
      margin-top: 10px;
    }
    .legend .key{display:flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.11);background:rgba(0,0,0,.16);font-size:12px;color:var(--muted)}
    .sw{width:10px;height:10px;border-radius:99px}

    /* Flow */
    .flow{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .flowNode{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 12px;
      position: relative;
    }
    .flowNode h3{margin:0 0 6px;font-size: 14px}
    .flowNode p{margin:0;color:var(--muted);font-size: 13px;line-height:1.5}
    .flowNode .meta{margin-top:10px;display:flex;flex-wrap:wrap;gap:8px}
    .badge{font-size:11px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);color:var(--muted);border-radius:999px;padding:5px 9px}

    /* Checklist */
    .checklist{display:grid;gap: 10px}
    .item{
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 12px;
      display:grid;
      grid-template-columns: 22px 1fr;
      gap: 10px;
      align-items:start;
    }
    .item input{margin-top:3px;accent-color: var(--violet)}
    .item .t{display:flex;justify-content:space-between;gap:12px;align-items:baseline}
    .item .t strong{font-size: 14px}
    .item .t em{font-style:normal;color:var(--muted);font-size:12px}
    .item .d{margin-top:6px;color:var(--muted);font-size: 13px;line-height:1.55}

    /* Risk grid */
    .riskGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 640px){
      .riskGrid{grid-template-columns:1fr}
    }

    .risk{
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 12px;
    }
    .risk .rTop{display:flex;justify-content:space-between;gap:10px;align-items:center}
    .risk strong{font-size: 13px}
    .meter{height: 10px;border-radius:99px;background: rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.10);overflow:hidden;margin-top:10px}
    .meter > i{display:block;height:100%;width:50%;background: linear-gradient(90deg, var(--violet), var(--bad));filter:saturate(1.1)}
    .risk p{margin:8px 0 0;color:var(--muted);font-size: 12px;line-height:1.45}

    /* Commentary */
    details{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 12px;
    }
    details + details{margin-top:10px}
    summary{
      cursor:pointer;
      list-style:none;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      user-select:none;
    }
    summary::-webkit-details-marker{display:none}
    summary strong{font-size: 14px}
    summary .hint{font-size:12px;color:var(--muted)}
    .detailBody{margin-top:10px;color:var(--muted);font-size: 13px;line-height:1.6}
    .callout{
      border-left: 3px solid rgba(187,167,255,.7);
      padding: 10px 12px;
      background: rgba(187,167,255,.08);
      border-radius: 14px;
      margin-top: 10px;
      color: rgba(255,255,255,.82);
    }

    /* Footer */
    footer{
      margin-top: 16px;
      padding: 14px 16px;
      border: 1px dashed rgba(255,255,255,.16);
      border-radius: var(--radius);
      color: var(--muted);
      font-size: 12px;
      line-height: 1.6;
      background: rgba(0,0,0,.14);
    }

    /* Utility */
    .mono{font-family:var(--mono)}
    .row2{display:grid;grid-template-columns: 1fr 1fr;gap: 12px}
    @media (max-width: 860px){.row2{grid-template-columns:1fr}}

    .hr{
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.14), transparent);
      margin: 12px 0;
    }

    /* Button */
    .btn{
      appearance:none;border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      font-size: 13px;
    }
    .btn:hover{transform: translateY(-1px);border-color: rgba(255,255,255,.26);background: rgba(255,255,255,.07)}
    .btnRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(10,14,22,.78);
      border: 1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.86);
      padding: 10px 12px;
      border-radius: 14px;
      box-shadow: 0 20px 70px rgba(0,0,0,.5);
      font-size: 12px;
      max-width: min(720px, calc(100vw - 24px));
      display:none;
      backdrop-filter: blur(10px);
    }

    /* Pattern mapping cards */
    .patternGrid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 980px){
      .patternGrid{grid-template-columns: repeat(2, minmax(0,1fr))}
    }
    @media (max-width: 560px){
      .patternGrid{grid-template-columns:1fr}
    }

    .patternCard{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 14px;
      cursor: pointer;
      transition: border-color .2s, background .2s, transform .15s;
      position: relative;
      overflow: hidden;
    }
    .patternCard:hover{
      border-color: rgba(187,167,255,.35);
      background: rgba(187,167,255,.06);
      transform: translateY(-2px);
    }
    .patternCard.active{
      border-color: rgba(187,167,255,.5);
      background: rgba(187,167,255,.08);
    }
    .patternCard .pcLabel{
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .1em;
      margin-bottom: 6px;
    }
    .patternCard h3{margin: 0 0 6px; font-size: 14px}
    .patternCard .pcChild{color: var(--warn); font-size: 12px; margin-bottom: 4px}
    .patternCard .pcArrow{color: var(--faint); font-size: 11px; margin: 4px 0}
    .patternCard .pcAdult{color: var(--bad); font-size: 12px}
    .patternCard .pcInsight{
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(255,255,255,.08);
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
      display: none;
    }
    .patternCard.active .pcInsight{display: block}

    /* Iceberg */
    .icebergWrap{position: relative}

    /* Quote block */
    .quoteBlock{
      border: 1px solid rgba(187,167,255,.25);
      border-radius: 16px;
      background: rgba(187,167,255,.06);
      padding: 16px 18px;
      margin: 10px 0;
      position: relative;
    }
    .quoteBlock::before{
      content: '\201C';
      position: absolute;
      top: -4px;
      left: 12px;
      font-size: 48px;
      color: rgba(187,167,255,.3);
      font-family: Georgia, serif;
      line-height: 1;
    }
    .quoteBlock p{
      margin: 0;
      font-size: 15px;
      line-height: 1.6;
      font-style: italic;
      color: rgba(255,255,255,.85);
      padding-left: 20px;
    }
    .quoteBlock .qAttr{
      margin-top: 8px;
      font-size: 12px;
      color: var(--violet);
      font-style: normal;
      padding-left: 20px;
    }

    /* Emotion selector */
    .emotionGrid{
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }
    @media (max-width: 640px){
      .emotionGrid{grid-template-columns: repeat(2, 1fr)}
    }
    .emotionBtn{
      appearance: none;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      padding: 12px 10px;
      border-radius: 14px;
      cursor: pointer;
      transition: all .15s;
      font-size: 13px;
      text-align: center;
    }
    .emotionBtn:hover{
      border-color: rgba(187,167,255,.4);
      background: rgba(187,167,255,.08);
      color: var(--text);
    }
    .emotionBtn.selected{
      border-color: rgba(187,167,255,.6);
      background: rgba(187,167,255,.12);
      color: var(--text);
      box-shadow: 0 0 20px rgba(187,167,255,.15);
    }

    /* Transformation comparison */
    .transformGrid{
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 0;
      align-items: stretch;
    }
    @media (max-width: 740px){
      .transformGrid{grid-template-columns: 1fr; gap: 10px}
      .transformDivider{display: none}
    }
    .transformCol{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 14px;
    }
    .transformCol h3{margin: 0 0 10px; font-size: 14px}
    .transformCol ul{margin: 0; padding: 0; list-style: none}
    .transformCol ul li{
      padding: 6px 0;
      font-size: 13px;
      color: var(--muted);
      border-bottom: 1px solid rgba(255,255,255,.06);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .transformCol ul li:last-child{border-bottom: none}
    .transformDivider{
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 10px;
      color: var(--faint);
      font-size: 24px;
    }

    /* Loop SVG animation */
    @keyframes loopPulse{
      0%,100%{opacity:.4}
      50%{opacity:.9}
    }
    .loopPulse{animation: loopPulse 3s ease-in-out infinite}

    @keyframes fadeSlide{
      from{opacity:0;transform:translateY(8px)}
      to{opacity:1;transform:translateY(0)}
    }
    .fadeIn{animation: fadeSlide .4s ease forwards}

    /* Three col grid */
    .threeCol{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 10px;
    }
    @media (max-width: 860px){
      .threeCol{grid-template-columns:1fr}
    }

    /* Print-friendly */
    @media print{
      body{background:white;color:#111}
      header,.card,details{box-shadow:none}
      .toast{display:none !important}
      .patternCard .pcInsight{display:block}
    }
  </style>
</head>
<body>
  <div class="wrap">

    <header>
      <div class="heroArt" aria-hidden="true">
        <svg viewBox="0 0 520 260" role="img">
          <defs>
            <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0" stop-color="rgba(187,167,255,.55)" />
              <stop offset="1" stop-color="rgba(255,122,153,.45)" />
            </linearGradient>
            <linearGradient id="g2" x1="0" x2="1" y1="1" y2="0">
              <stop offset="0" stop-color="rgba(255,210,122,.40)" />
              <stop offset="1" stop-color="rgba(187,167,255,.35)" />
            </linearGradient>
            <filter id="blurGlow" x="-30%" y="-30%" width="160%" height="160%">
              <feGaussianBlur stdDeviation="14" result="b"/>
              <feColorMatrix in="b" type="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7" result="g"/>
              <feMerge>
                <feMergeNode in="g"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          <g filter="url(#blurGlow)">
            <!-- Abstract psyche layers -->
            <ellipse cx="260" cy="130" rx="180" ry="80" fill="none" stroke="url(#g1)" stroke-width="2" opacity=".3"/>
            <ellipse cx="260" cy="130" rx="120" ry="55" fill="none" stroke="url(#g1)" stroke-width="3" opacity=".5"/>
            <ellipse cx="260" cy="130" rx="60" ry="28" fill="none" stroke="url(#g2)" stroke-width="4" opacity=".7"/>
            <!-- Connection threads -->
            <path d="M80,200 C140,80 200,180 260,60 C320,180 380,80 440,200" fill="none" stroke="url(#g1)" stroke-width="6" stroke-linecap="round" opacity=".5" />
            <path d="M120,220 C180,120 230,200 280,100 C330,200 370,120 420,220" fill="none" stroke="url(#g2)" stroke-width="4" stroke-linecap="round" opacity=".4" />
            <!-- Nodes representing memories -->
            <circle cx="260" cy="60" r="8" fill="rgba(187,167,255,.7)" />
            <circle cx="160" cy="160" r="6" fill="rgba(255,210,122,.6)" />
            <circle cx="360" cy="160" r="6" fill="rgba(255,122,153,.6)" />
            <circle cx="260" cy="130" r="5" fill="rgba(255,255,255,.7)" />
            <circle cx="200" cy="100" r="4" fill="rgba(117,240,182,.5)" />
            <circle cx="320" cy="100" r="4" fill="rgba(122,215,255,.5)" />
          </g>
        </svg>
      </div>

      <div class="headerGrid">
        <div>
          <div class="kicker"><span class="dot"></span> jungian psychology &bull; shadow work &bull; attachment</div>
          <h1>Your Sexual Desire Was Shaped by Childhood</h1>
          <p class="subtitle">
            Carl Jung believed that nothing intense in adulthood comes from nowhere. Your desire didn't begin with hormones or attraction&mdash;it began when you were powerless, watching, absorbing, adapting. <b>Survival leaves patterns</b>, and those patterns become the hidden architecture of adult desire.
          </p>
          <div class="btnRow">
            <button class="btn" id="jumpPatterns">Explore the patterns</button>
            <button class="btn" id="jumpIceberg">See the iceberg</button>
            <button class="btn" id="jumpReflect">Self-reflection tool</button>
            <button class="btn" id="toggleNotes">Toggle commentary</button>
          </div>
        </div>

        <div class="topStats" aria-label="Key claims summarized">
          <div class="stat">
            <div class="label">Core thesis</div>
            <div class="value" style="color:var(--violet)">Desire = Memory</div>
            <div class="note">The unconscious doesn't think in morals. It thinks in memory and repeats until made conscious.</div>
          </div>
          <div class="stat">
            <div class="label">Pattern origin</div>
            <div class="value" style="color:var(--warn)">Childhood Adaptation</div>
            <div class="note">You didn't choose your environment. You learned to survive it. That adaptation became identity.</div>
          </div>
          <div class="stat">
            <div class="label">Jung's mechanism</div>
            <div class="value" style="color:var(--bad)">Compulsion to Repeat</div>
            <div class="note">The unconscious attempt to resolve unfinished emotional experiences through desire.</div>
          </div>
          <div class="stat">
            <div class="label">Resolution</div>
            <div class="value" style="color:var(--good)">Integration, not Suppression</div>
            <div class="note">Freedom comes when instincts are made conscious, not eliminated.</div>
          </div>
        </div>
      </div>
    </header>

    <div class="grid">

      <!-- SECTION 1: The Core Thesis -->
      <section class="card" aria-label="Core thesis">
        <div class="cardHeader">
          <h2>The origin of desire: a Jungian framework</h2>
          <div class="chip"><b>Key idea:</b> desire is symbolic, not random</div>
        </div>
        <div class="cardBody">
          <div class="split">
            <div>
              <p class="muted" style="margin-top:0">
                Jung proposed that sexual desire is not a purely biological drive. It is a <b>psychological artifact</b>&mdash;a product of childhood emotional learning that the unconscious replays in adulthood. Your body remembers before your mind explains.
              </p>
              <div class="quoteBlock">
                <p>What we repress does not disappear. It acts autonomously.</p>
                <div class="qAttr">&mdash; Carl Jung (paraphrased)</div>
              </div>
              <p class="muted">
                As a child, you learned what connection <em>felt like</em>&mdash;not what it was supposed to be, but what it actually was. Maybe attention came only when you behaved a certain way. Maybe love required silence. Maybe closeness meant emotional labor. Your psyche stored that as "intimacy."
              </p>
            </div>
            <div>
              <div class="viz" aria-label="Childhood to desire flow">
                <svg viewBox="0 0 480 400" role="img" aria-label="How childhood experience becomes adult desire">
                  <defs>
                    <linearGradient id="flowG1" x1="0" x2="0" y1="0" y2="1">
                      <stop offset="0" stop-color="rgba(255,210,122,.6)" />
                      <stop offset="1" stop-color="rgba(187,167,255,.6)" />
                    </linearGradient>
                    <linearGradient id="flowG2" x1="0" x2="0" y1="0" y2="1">
                      <stop offset="0" stop-color="rgba(187,167,255,.6)" />
                      <stop offset="1" stop-color="rgba(255,122,153,.6)" />
                    </linearGradient>
                    <filter id="softGlow" x="-20%" y="-20%" width="140%" height="140%">
                      <feGaussianBlur stdDeviation="6" result="b"/>
                      <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                  </defs>
                  <g filter="url(#softGlow)">
                    <!-- Stage 1: Childhood -->
                    <rect x="120" y="20" width="240" height="56" rx="28" fill="rgba(255,210,122,.12)" stroke="rgba(255,210,122,.4)" stroke-width="1.5"/>
                    <text x="240" y="54" text-anchor="middle" font-size="14" fill="rgba(255,210,122,.95)" font-weight="700">Childhood Environment</text>

                    <!-- Arrow down -->
                    <path d="M240,76 L240,110" stroke="url(#flowG1)" stroke-width="3" stroke-linecap="round" opacity=".8"/>
                    <polygon points="232,106 240,118 248,106" fill="rgba(255,210,122,.5)"/>

                    <!-- Stage 2: Adaptation -->
                    <rect x="100" y="120" width="280" height="56" rx="28" fill="rgba(255,179,138,.10)" stroke="rgba(255,179,138,.35)" stroke-width="1.5"/>
                    <text x="240" y="154" text-anchor="middle" font-size="14" fill="rgba(255,179,138,.95)" font-weight="700">Emotional Adaptation (Survival)</text>

                    <!-- Arrow down -->
                    <path d="M240,176 L240,210" stroke="url(#flowG1)" stroke-width="3" stroke-linecap="round" opacity=".8"/>
                    <polygon points="232,206 240,218 248,206" fill="rgba(187,167,255,.5)"/>

                    <!-- Stage 3: Unconscious Storage -->
                    <rect x="80" y="220" width="320" height="56" rx="28" fill="rgba(187,167,255,.10)" stroke="rgba(187,167,255,.35)" stroke-width="1.5"/>
                    <text x="240" y="254" text-anchor="middle" font-size="14" fill="rgba(187,167,255,.95)" font-weight="700">Unconscious Pattern Storage</text>

                    <!-- Arrow down -->
                    <path d="M240,276 L240,310" stroke="url(#flowG2)" stroke-width="3" stroke-linecap="round" opacity=".8"/>
                    <polygon points="232,306 240,318 248,306" fill="rgba(255,122,153,.5)"/>

                    <!-- Stage 4: Adult Desire -->
                    <rect x="60" y="320" width="360" height="56" rx="28" fill="rgba(255,122,153,.10)" stroke="rgba(255,122,153,.35)" stroke-width="1.5"/>
                    <text x="240" y="354" text-anchor="middle" font-size="14" fill="rgba(255,122,153,.95)" font-weight="700">Adult Sexual Desire (Symbolic Expression)</text>

                    <!-- Side labels -->
                    <text x="30" y="50" font-size="11" fill="rgba(255,255,255,.45)" text-anchor="end" transform="rotate(-90 30 50)">PAST</text>
                    <text x="30" y="350" font-size="11" fill="rgba(255,255,255,.45)" text-anchor="end" transform="rotate(-90 30 350)">PRESENT</text>
                  </g>
                </svg>
                <div class="small" style="margin-top:6px">The psyche stores childhood emotional reality as a template, then replays it through adult desire.</div>
              </div>
            </div>
          </div>
          <div class="callout" data-commentary>
            <b>Commentary:</b> This is a psychoanalytic model, not a neuroscience finding. Its value is as a lens for self-understanding: "what does my desire pattern <em>point to</em>?" rather than "what causes arousal biochemically?" Both frames can coexist.
          </div>
        </div>
      </section>

      <!-- SECTION 2: Pattern Mapping -->
      <section class="card" id="patterns" aria-label="Pattern mapping">
        <div class="cardHeader">
          <h2>Childhood adaptation becomes desire pattern</h2>
          <div class="chip"><b>Interactive:</b> click to explore</div>
        </div>
        <div class="cardBody">
          <p class="muted" style="margin-top:0">
            According to Jung, each childhood emotional climate creates a specific adaptation, which then manifests as a recognizable desire pattern in adulthood. Click any pattern to reveal the deeper insight.
          </p>

          <div class="patternGrid" id="patternGrid">
            <div class="patternCard" data-idx="0">
              <div class="pcLabel" style="color:var(--warn)">Childhood</div>
              <h3>Inconsistent Love</h3>
              <div class="pcChild">Affection was unpredictable, sometimes present, sometimes withdrawn</div>
              <div class="pcArrow">creates in adulthood &#8595;</div>
              <div class="pcAdult">Desire learns to <b>chase</b>. Alertness becomes excitement. Distance feels magnetic.</div>
              <div class="pcInsight">Your nervous system learned to stay hypervigilant for signs of love. That vigilance later feels like passionate attraction. You mistake anxiety for chemistry because your body was trained to equate uncertainty with connection.</div>
            </div>

            <div class="patternCard" data-idx="1">
              <div class="pcLabel" style="color:var(--warn)">Childhood</div>
              <h3>Conditional Affection</h3>
              <div class="pcChild">Love required performing, achieving, or being "good enough"</div>
              <div class="pcArrow">creates in adulthood &#8595;</div>
              <div class="pcAdult">Desire learns to <b>perform</b>. Effort feels erotic. You earn closeness.</div>
              <div class="pcInsight">You internalized that love has a price tag. In adult intimacy, you unconsciously believe you must "deserve" desire. Relaxed, unconditional attraction feels suspicious because it doesn't match your childhood contract.</div>
            </div>

            <div class="patternCard" data-idx="2">
              <div class="pcLabel" style="color:var(--warn)">Childhood</div>
              <h3>Warmth + Tension</h3>
              <div class="pcChild">Closeness always came packaged with conflict or anxiety</div>
              <div class="pcArrow">creates in adulthood &#8595;</div>
              <div class="pcAdult">Desire learns <b>confusion</b>. Arousal coexists with fear, guilt, or emptiness.</div>
              <div class="pcInsight">Your psyche fused love and danger into a single experience. Calm intimacy feels "too flat" because your nervous system expects turbulence as proof that something real is happening.</div>
            </div>

            <div class="patternCard" data-idx="3">
              <div class="pcLabel" style="color:var(--warn)">Childhood</div>
              <h3>Unsafe Closeness</h3>
              <div class="pcChild">Intimacy felt overwhelming, invasive, or boundary-crossing</div>
              <div class="pcArrow">creates in adulthood &#8595;</div>
              <div class="pcAdult">Desire learns <b>distance</b>. Sex requires emotions to stay muted. Pleasure without vulnerability.</div>
              <div class="pcInsight">This is not avoidance. It is protection. The psyche always protects first. You learned that closeness without control leads to being consumed, so desire only feels safe when you can regulate how much of yourself you reveal.</div>
            </div>

            <div class="patternCard" data-idx="4">
              <div class="pcLabel" style="color:var(--warn)">Childhood</div>
              <h3>Emotional Neglect</h3>
              <div class="pcChild">Core emotional needs were consistently ignored or minimized</div>
              <div class="pcArrow">creates in adulthood &#8595;</div>
              <div class="pcAdult">The shadow learns <b>hunger</b>. You may crave validation but feel it as lust.</div>
              <div class="pcInsight">Desire becomes a disguise for unmet needs. You may crave safety but feel it as obsession. You may crave connection but feel it as attraction to unavailable people. Desire is not about pleasure&mdash;it is about regulation.</div>
            </div>

            <div class="patternCard" data-idx="5">
              <div class="pcLabel" style="color:var(--warn)">Childhood</div>
              <h3>Premature Responsibility</h3>
              <div class="pcChild">You became the caretaker, mediator, or emotional adult too early</div>
              <div class="pcArrow">creates in adulthood &#8595;</div>
              <div class="pcAdult">Desire seeks <b>surrender</b>. Fantasy gravitates toward being chosen, consumed, released from control.</div>
              <div class="pcInsight">A child who felt responsible may fantasize about surrender. The desire is not the literal act&mdash;it is the emotional position. You are seeking the experience of being held without having to hold everything together.</div>
            </div>
          </div>

          <div class="hr"></div>
          <div class="small">These are simplified archetypes based on the Jungian framework. Real patterns are always blended and unique to each individual's experience.</div>

          <div class="callout" data-commentary>
            <b>Commentary:</b> Pattern recognition is not diagnosis. These categories serve as mirrors, not labels. Jung's insight is that desire "asks" something&mdash;the therapeutic value is in pausing to listen rather than rushing to judge. Two people can show the same pattern for very different developmental reasons.
          </div>
        </div>
      </section>

      <!-- SECTION 3: The Iceberg - Conscious vs Unconscious -->
      <section class="row">
        <div class="card" id="iceberg" aria-label="Iceberg visualization">
          <div class="cardHeader">
            <h2>The iceberg of desire</h2>
            <div class="chip"><b>Visible vs. hidden</b></div>
          </div>
          <div class="cardBody">
            <p class="muted" style="margin-top:0">
              Sexual desire is like an iceberg: what you consciously experience is only the surface. Beneath it lies a vast unconscious architecture of memory, adaptation, and unfinished emotional business.
            </p>

            <div class="viz icebergWrap" aria-label="Iceberg diagram">
              <svg viewBox="0 0 600 480" id="icebergSvg" role="img" aria-label="Iceberg showing conscious desire above waterline and unconscious drivers below">
                <defs>
                  <linearGradient id="waterG" x1="0" x2="0" y1="0" y2="1">
                    <stop offset="0" stop-color="rgba(122,215,255,.08)" />
                    <stop offset="1" stop-color="rgba(187,167,255,.15)" />
                  </linearGradient>
                  <linearGradient id="iceTop" x1="0" x2="0" y1="0" y2="1">
                    <stop offset="0" stop-color="rgba(255,255,255,.25)" />
                    <stop offset="1" stop-color="rgba(187,167,255,.15)" />
                  </linearGradient>
                  <linearGradient id="iceBot" x1="0" x2="0" y1="0" y2="1">
                    <stop offset="0" stop-color="rgba(187,167,255,.12)" />
                    <stop offset="1" stop-color="rgba(255,122,153,.10)" />
                  </linearGradient>
                  <filter id="iceGlow" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur stdDeviation="4" result="b"/>
                    <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
                  </filter>
                </defs>

                <!-- Water line -->
                <rect x="0" y="140" width="600" height="340" fill="url(#waterG)" rx="0"/>
                <line x1="0" y1="140" x2="600" y2="140" stroke="rgba(122,215,255,.35)" stroke-width="1.5" stroke-dasharray="8 4"/>
                <text x="560" y="134" font-size="11" fill="rgba(122,215,255,.7)" text-anchor="end">AWARENESS LINE</text>

                <g filter="url(#iceGlow)">
                  <!-- Iceberg top (above water) -->
                  <path d="M250,30 L340,30 L370,140 L220,140 Z" fill="url(#iceTop)" stroke="rgba(255,255,255,.25)" stroke-width="1"/>

                  <!-- Iceberg bottom (below water) -->
                  <path d="M200,140 L390,140 L440,260 L460,340 L400,420 L190,420 L140,340 L150,260 Z" fill="url(#iceBot)" stroke="rgba(187,167,255,.20)" stroke-width="1"/>
                </g>

                <!-- Labels above water -->
                <g font-size="12" fill="rgba(255,255,255,.85)">
                  <text x="295" y="75" text-anchor="middle" font-weight="700" font-size="13">Conscious Desire</text>
                  <text x="295" y="95" text-anchor="middle" fill="rgba(255,255,255,.6)" font-size="11">Attraction, arousal, preferences</text>
                  <text x="295" y="115" text-anchor="middle" fill="rgba(255,255,255,.5)" font-size="11">"I want this person / this feeling"</text>
                </g>

                <!-- Labels below water -->
                <g font-size="12">
                  <text x="295" y="175" text-anchor="middle" fill="rgba(187,167,255,.9)" font-weight="700">Attachment Patterns</text>
                  <text x="295" y="195" text-anchor="middle" fill="rgba(255,255,255,.55)" font-size="11">How closeness was learned</text>

                  <text x="295" y="230" text-anchor="middle" fill="rgba(255,179,138,.85)" font-weight="700">Emotional Memory</text>
                  <text x="295" y="250" text-anchor="middle" fill="rgba(255,255,255,.55)" font-size="11">What connection actually felt like</text>

                  <text x="295" y="285" text-anchor="middle" fill="rgba(255,210,122,.85)" font-weight="700">Survival Adaptations</text>
                  <text x="295" y="305" text-anchor="middle" fill="rgba(255,255,255,.55)" font-size="11">How you shaped yourself to be loved</text>

                  <text x="295" y="340" text-anchor="middle" fill="rgba(255,122,153,.85)" font-weight="700">Unmet Core Needs</text>
                  <text x="295" y="360" text-anchor="middle" fill="rgba(255,255,255,.55)" font-size="11">What was never received, now sought compulsively</text>

                  <text x="295" y="400" text-anchor="middle" fill="rgba(187,167,255,.75)" font-weight="700" font-size="13">The Shadow</text>
                  <text x="295" y="418" text-anchor="middle" fill="rgba(255,255,255,.50)" font-size="11">What you suppressed to belong, survive, be loved</text>
                </g>

                <!-- Percentage labels -->
                <text x="40" y="90" font-size="22" fill="rgba(255,255,255,.3)" font-weight="700">~10%</text>
                <text x="40" y="300" font-size="22" fill="rgba(187,167,255,.3)" font-weight="700">~90%</text>
              </svg>
            </div>

            <div class="legend" aria-label="Legend">
              <div class="key"><span class="sw" style="background: rgba(255,255,255,.25)"></span> Conscious (what you see)</div>
              <div class="key"><span class="sw" style="background: rgba(187,167,255,.4)"></span> Unconscious (what drives you)</div>
              <div class="key"><span class="sw" style="background: rgba(255,122,153,.4)"></span> Shadow material</div>
            </div>

            <div class="callout" data-commentary>
              <b>Commentary:</b> The iceberg metaphor is powerful but imprecise. Jung would emphasize that the unconscious is not "hidden" by someone&mdash;it is simply the domain the ego hasn't illuminated yet. Integration is expanding the conscious portion, not emptying the unconscious.
            </div>
          </div>
        </div>

        <div class="card" aria-label="The Shadow and Desire">
          <div class="cardHeader">
            <h2>The Shadow speaks through desire</h2>
            <div class="chip">what was suppressed returns</div>
          </div>
          <div class="cardBody">
            <p class="muted" style="margin-top:0">
              The shadow is not immoral. It is <b>unintegrated memory</b>. It holds what you had to suppress to belong, survive, be loved. Sex becomes one of the strongest stages where these unresolved energies perform.
            </p>

            <div class="quoteBlock">
              <p>Your shadow is not immoral. It is unintegrated memory.</p>
              <div class="qAttr">&mdash; Jungian framework</div>
            </div>

            <div class="flow" aria-label="Shadow dynamics">
              <div class="flowNode">
                <h3>Emotional needs ignored</h3>
                <p>The shadow learns <b style="color:var(--bad)">hunger</b>&mdash;desire becomes a disguised cry for what was never given.</p>
                <div class="meta"><span class="badge">validation as lust</span><span class="badge">safety as obsession</span></div>
              </div>
              <div class="flowNode">
                <h3>Boundaries crossed</h3>
                <p>The shadow learns <b style="color:var(--orange)">confusion</b>&mdash;intimacy and violation become entangled in the psyche.</p>
                <div class="meta"><span class="badge">conflated signals</span><span class="badge">arousal + fear</span></div>
              </div>
              <div class="flowNode">
                <h3>Love was inconsistent</h3>
                <p>The shadow learns <b style="color:var(--warn)">longing</b>&mdash;desire pursues what retreats because absence was the texture of love.</p>
                <div class="meta"><span class="badge">chase dynamics</span><span class="badge">unavailable partners</span></div>
              </div>
            </div>

            <div class="hr"></div>

            <details data-commentary>
              <summary><strong>Why shame follows desire</strong><span class="hint">click to expand</span></summary>
              <div class="detailBody">
                <p>Shame is not about sex itself. It is about the old self who learned to want quietly, to need without asking, to accept crumbs as intimacy. Shame enters when desire clashes with your conscious identity: "Why do I want this? What is wrong with me?" But judgment never dissolves a pattern. <b>Awareness does.</b></p>
              </div>
            </details>

            <details data-commentary>
              <summary><strong>Fantasy as metaphor, not literal wish</strong><span class="hint">click to expand</span></summary>
              <div class="detailBody">
                <p>Sexual fantasies are symbolic, not literal. The fantasy is not about the act&mdash;it is about the <em>emotional position</em>: power, submission, being chosen, being seen, being consumed, being in control. A child who felt powerless may fantasize about control. A child who felt invisible may fantasize about being desired intensely. These are not perversions. They are metaphors the unconscious uses because it does not think in words.</p>
              </div>
            </details>

            <div class="callout" data-commentary>
              <b>Commentary:</b> Jung's framework does not pathologize fantasy. It asks you to read it as symbolic communication from the unconscious. The therapeutic move is interpretation, not judgment. "What emotional need does this fantasy address?" is the productive question.
            </div>
          </div>
        </div>
      </section>

      <!-- SECTION 4: The Repetition Loop -->
      <section class="card" aria-label="Repetition loop">
        <div class="cardHeader">
          <h2>The repetition loop: why patterns keep returning</h2>
          <div class="chip"><b>Interactive:</b> break the cycle</div>
        </div>
        <div class="cardBody">
          <div class="split">
            <div>
              <p class="muted" style="margin-top:0">
                Jung called this the <b>compulsion to repeat</b>: the unconscious attempt to resolve unfinished emotional experiences. You are not chasing pleasure. You are chasing completion.
              </p>
              <p class="muted">
                You meet someone. They trigger the old emotional pattern. Your body responds before your mind does. Desire ignites. You feel pulled, excited, alive. Then the familiar pain returns&mdash;distance, confusion, overgiving, shame. The cycle repeats, not because you enjoy suffering, but because the psyche believes this is how closeness works.
              </p>
              <p class="muted">
                Use the slider below to explore what happens when awareness enters the loop.
              </p>

              <div class="control" style="margin-top:12px">
                <label>
                  <span>Awareness level</span>
                  <span class="readout" id="awarenessReadout">Low</span>
                </label>
                <input id="awarenessSlider" type="range" min="0" max="100" value="15" />
                <div class="small" style="margin-top:8px">Move from unconscious repetition toward conscious choice.</div>
              </div>

              <div id="awarenessMsg" class="small" style="margin-top:10px;min-height:40px"></div>
            </div>
            <div>
              <div class="viz" aria-label="Repetition cycle diagram">
                <svg viewBox="0 0 480 440" id="loopSvg" role="img" aria-label="Circular repetition loop with awareness breaking point">
                  <defs>
                    <linearGradient id="loopG1" x1="0" x2="1" y1="0" y2="1">
                      <stop offset="0" stop-color="rgba(255,122,153,.5)" />
                      <stop offset="1" stop-color="rgba(187,167,255,.5)" />
                    </linearGradient>
                    <filter id="loopGlow" x="-20%" y="-20%" width="140%" height="140%">
                      <feGaussianBlur stdDeviation="5" result="b"/>
                      <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                  </defs>

                  <g filter="url(#loopGlow)">
                    <!-- Central circle path -->
                    <circle cx="240" cy="210" r="140" fill="none" stroke="rgba(255,255,255,.08)" stroke-width="30"/>

                    <!-- Loop arc - will be modified by JS -->
                    <circle id="loopArc" cx="240" cy="210" r="140" fill="none" stroke="url(#loopG1)" stroke-width="4" stroke-linecap="round" stroke-dasharray="880" stroke-dashoffset="0" class="loopPulse"/>

                    <!-- Break point - awareness -->
                    <circle id="breakPoint" cx="240" cy="70" r="0" fill="rgba(117,240,182,.6)" opacity="0"/>
                    <text id="breakLabel" x="240" y="46" text-anchor="middle" font-size="12" fill="rgba(117,240,182,0)" font-weight="700">AWARENESS</text>

                    <!-- Stage nodes -->
                    <g id="loopNodes">
                      <!-- Trigger (top-right) -->
                      <circle cx="362" cy="140" r="22" fill="rgba(255,210,122,.15)" stroke="rgba(255,210,122,.5)" stroke-width="1.5"/>
                      <text x="362" y="144" text-anchor="middle" font-size="10" fill="rgba(255,210,122,.9)" font-weight="700">TRIGGER</text>
                      <text x="398" y="122" font-size="9" fill="rgba(255,255,255,.5)">familiar pattern</text>

                      <!-- Body Response (right) -->
                      <circle cx="380" cy="240" r="22" fill="rgba(255,179,138,.15)" stroke="rgba(255,179,138,.5)" stroke-width="1.5"/>
                      <text x="380" y="237" text-anchor="middle" font-size="9" fill="rgba(255,179,138,.9)" font-weight="700">BODY</text>
                      <text x="380" y="249" text-anchor="middle" font-size="9" fill="rgba(255,179,138,.9)" font-weight="700">RESPONDS</text>
                      <text x="420" y="266" font-size="9" fill="rgba(255,255,255,.5)">before mind</text>

                      <!-- Desire Ignites (bottom-right) -->
                      <circle cx="320" cy="340" r="22" fill="rgba(255,122,153,.15)" stroke="rgba(255,122,153,.5)" stroke-width="1.5"/>
                      <text x="320" y="337" text-anchor="middle" font-size="9" fill="rgba(255,122,153,.9)" font-weight="700">DESIRE</text>
                      <text x="320" y="349" text-anchor="middle" font-size="9" fill="rgba(255,122,153,.9)" font-weight="700">IGNITES</text>
                      <text x="356" y="366" font-size="9" fill="rgba(255,255,255,.5)">excitement</text>

                      <!-- Familiar Pain (bottom-left) -->
                      <circle cx="160" cy="340" r="22" fill="rgba(187,167,255,.15)" stroke="rgba(187,167,255,.5)" stroke-width="1.5"/>
                      <text x="160" y="337" text-anchor="middle" font-size="9" fill="rgba(187,167,255,.9)" font-weight="700">FAMILIAR</text>
                      <text x="160" y="349" text-anchor="middle" font-size="9" fill="rgba(187,167,255,.9)" font-weight="700">PAIN</text>
                      <text x="116" y="366" font-size="9" fill="rgba(255,255,255,.5)">shame, distance</text>

                      <!-- Unconscious Need (left) -->
                      <circle cx="100" cy="240" r="22" fill="rgba(122,215,255,.15)" stroke="rgba(122,215,255,.5)" stroke-width="1.5"/>
                      <text x="100" y="237" text-anchor="middle" font-size="9" fill="rgba(122,215,255,.9)" font-weight="700">UNMET</text>
                      <text x="100" y="249" text-anchor="middle" font-size="9" fill="rgba(122,215,255,.9)" font-weight="700">NEED</text>
                      <text x="60" y="266" font-size="9" fill="rgba(255,255,255,.5)">still seeking</text>

                      <!-- Seeking Again (top-left) -->
                      <circle cx="118" cy="140" r="22" fill="rgba(255,210,122,.15)" stroke="rgba(255,210,122,.5)" stroke-width="1.5"/>
                      <text x="118" y="137" text-anchor="middle" font-size="9" fill="rgba(255,210,122,.9)" font-weight="700">SEEK</text>
                      <text x="118" y="149" text-anchor="middle" font-size="9" fill="rgba(255,210,122,.9)" font-weight="700">AGAIN</text>
                      <text x="78" y="122" font-size="9" fill="rgba(255,255,255,.5)">compulsion</text>
                    </g>

                    <!-- Center label -->
                    <text id="centerLabel" x="240" y="206" text-anchor="middle" font-size="14" fill="rgba(255,255,255,.5)" font-weight="700">COMPULSION</text>
                    <text x="240" y="222" text-anchor="middle" font-size="11" fill="rgba(255,255,255,.35)">to repeat</text>
                  </g>
                </svg>
              </div>
            </div>
          </div>
          <div class="callout" data-commentary>
            <b>Commentary:</b> "Repetition requires blindness." This is one of Jung's most practically useful insights. The moment you can <em>name</em> the pattern while it is happening, identification weakens. You are no longer inside desire. You are in relationship with it. This is what Jung called ego differentiation.
          </div>
        </div>
      </section>

      <!-- SECTION 5: Fantasy as Symbol -->
      <section class="card" aria-label="Fantasy as symbol">
        <div class="cardHeader">
          <h2>Desire speaks in symbols: decoding fantasy</h2>
          <div class="chip">metaphor, not literal wish</div>
        </div>
        <div class="cardBody">
          <p class="muted" style="margin-top:0">
            The unconscious does not use language. It uses <b>symbols</b>. Sexual fantasies often surprise people precisely because they are not literal wishes&mdash;they are emotional equations, pointing to the childhood position that remains unresolved.
          </p>

          <div class="threeCol">
            <div class="flowNode">
              <h3 style="color:var(--cyan)">Felt powerless as a child</h3>
              <p>The psyche may create fantasies of <b>control</b>&mdash;scenarios where you hold complete power over the situation.</p>
              <div class="meta"><span class="badge" style="border-color:rgba(122,215,255,.3)">compensatory symbol</span></div>
            </div>
            <div class="flowNode">
              <h3 style="color:var(--violet)">Felt invisible as a child</h3>
              <p>The psyche may create fantasies of <b>being desired intensely</b>&mdash;being the center of someone's complete attention.</p>
              <div class="meta"><span class="badge" style="border-color:rgba(187,167,255,.3)">recognition hunger</span></div>
            </div>
            <div class="flowNode">
              <h3 style="color:var(--orange)">Felt responsible as a child</h3>
              <p>The psyche may create fantasies of <b>surrender</b>&mdash;being held, guided, released from the burden of always being in charge.</p>
              <div class="meta"><span class="badge" style="border-color:rgba(255,179,138,.3)">relief symbol</span></div>
            </div>
          </div>

          <div class="quoteBlock" style="margin-top:14px">
            <p>Desire speaks in images because the unconscious does not use language. And when those symbols are ignored, they grow louder.</p>
            <div class="qAttr">&mdash; Jungian framework</div>
          </div>

          <div class="callout" data-commentary>
            <b>Commentary:</b> This reframe is clinically important. Moving from "What is wrong with me?" to "What is this telling me?" transforms shame into curiosity. Jung would say the symbol is the psyche's <em>attempt at healing</em>, not evidence of damage. Suppressing a symbol doesn't resolve what it points to&mdash;it just forces the psyche to find a louder symbol.
          </div>
        </div>
      </section>

      <!-- SECTION 6: The Integration Path -->
      <section class="row">
        <div class="card" id="reflect" aria-label="Self-reflection tool">
          <div class="cardHeader">
            <h2>Self-reflection: what emotion comes first?</h2>
            <div class="chip"><b>Interactive:</b> trace desire backward</div>
          </div>
          <div class="cardBody">
            <p class="muted" style="margin-top:0">
              Jung suggests that when desire arises, you should pause&mdash;not to resist, but to observe. <b>What emotion comes first?</b> Desire rarely appears alone. It rides on another feeling. That feeling is the doorway.
            </p>

            <div class="small" style="margin-bottom:10px">Select the emotion that most often precedes your desire:</div>
            <div class="emotionGrid" id="emotionGrid">
              <button class="emotionBtn" data-emotion="loneliness">Loneliness</button>
              <button class="emotionBtn" data-emotion="tension">Tension</button>
              <button class="emotionBtn" data-emotion="restlessness">Restlessness</button>
              <button class="emotionBtn" data-emotion="invisibility">Invisibility</button>
              <button class="emotionBtn" data-emotion="powerlessness">Powerlessness</button>
              <button class="emotionBtn" data-emotion="boredom">Boredom</button>
              <button class="emotionBtn" data-emotion="anxiety">Anxiety</button>
              <button class="emotionBtn" data-emotion="emptiness">Emptiness</button>
            </div>

            <div id="emotionInsight" style="margin-top:12px;min-height:80px"></div>

            <div class="hr"></div>

            <div class="quoteBlock">
              <p>When you trace desire backward, you do not find sex. You find a younger self trying to regulate something unmet.</p>
              <div class="qAttr">&mdash; Jungian framework</div>
            </div>

            <div class="callout" data-commentary>
              <b>Commentary:</b> This is the core practical technique. Not suppression, not indulgence, but observation. The question is never "Why do I want this?" but rather "What part of me learned to want this?" This single reframe can transform your relationship with desire from adversarial to investigative.
            </div>
          </div>
        </div>

        <div class="card" aria-label="Integration pathway">
          <div class="cardHeader">
            <h2>The integration pathway</h2>
            <div class="chip">from compulsion to choice</div>
          </div>
          <div class="cardBody">
            <p class="muted" style="margin-top:0">
              Integration does not begin by changing behavior. It begins by changing <b>relationship</b>. Jung called this <em>ego differentiation</em>&mdash;the moment the conscious self stops being possessed by unconscious material.
            </p>

            <div class="checklist" id="integrationChecklist">
              <div class="item">
                <input type="checkbox" />
                <div>
                  <div class="t"><strong>Recognize the pattern</strong><em>step 1</em></div>
                  <div class="d">Stop asking "Why do I want this?" and start asking "What part of me learned to want this?" Name the childhood adaptation.</div>
                </div>
              </div>
              <div class="item">
                <input type="checkbox" />
                <div>
                  <div class="t"><strong>Observe without judgment</strong><em>step 2</em></div>
                  <div class="d">When desire arises, pause. Not to resist, but to witness. What emotion comes first? Follow it backward.</div>
                </div>
              </div>
              <div class="item">
                <input type="checkbox" />
                <div>
                  <div class="t"><strong>Separate memory from mandate</strong><em>step 3</em></div>
                  <div class="d">Realize this urge belongs to a memory, not a mandate. Awareness breaks identification.</div>
                </div>
              </div>
              <div class="item">
                <input type="checkbox" />
                <div>
                  <div class="t"><strong>Tolerate unfamiliar peace</strong><em>step 4</em></div>
                  <div class="d">Healthy intimacy may feel "boring" at first because your nervous system expects intensity. This is unfamiliar peace, not boredom.</div>
                </div>
              </div>
              <div class="item">
                <input type="checkbox" />
                <div>
                  <div class="t"><strong>Choose instead of react</strong><em>step 5</em></div>
                  <div class="d">Stop when something feels familiar instead of true. Respond to what is present, not what is patterned.</div>
                </div>
              </div>
              <div class="item">
                <input type="checkbox" />
                <div>
                  <div class="t"><strong>Allow desire to mature</strong><em>ongoing</em></div>
                  <div class="d">Desire becomes quieter, more grounded, less urgent, more selective&mdash;not weaker, but cleaner. Expression, not compensation.</div>
                </div>
              </div>
            </div>

            <div class="hr"></div>
            <div class="btnRow">
              <button class="btn" id="intScoreBtn">Check my integration progress</button>
              <button class="btn" id="intResetBtn">Reset checklist</button>
            </div>
            <div class="small" id="intScoreOut" style="margin-top:10px"></div>

            <div class="callout" data-commentary>
              <b>Commentary:</b> This is not a "fix in 5 steps" checklist. Integration is a lifelong process of deepening self-knowledge. Each step may take months or years. The goal is not to eliminate desire but to transform your relationship with it from unconscious possession to conscious dialogue.
            </div>
          </div>
        </div>
      </section>

      <!-- SECTION 7: Before/After Transformation -->
      <section class="card" aria-label="Transformation">
        <div class="cardHeader">
          <h2>The transformation: compulsive vs. integrated desire</h2>
          <div class="chip"><b>Thesis:</b> you don't lose desire, you lose compulsion</div>
        </div>
        <div class="cardBody">
          <p class="muted" style="margin-top:0">
            You do not lose desire when you heal. You lose <b>compulsive</b> desire. What remains is intimacy without hunger, attraction without fear, connection without self-betrayal.
          </p>

          <div class="transformGrid">
            <div class="transformCol" style="border-color: rgba(255,122,153,.25)">
              <h3 style="color:var(--bad)">Compulsive Desire (Before)</h3>
              <ul>
                <li><span style="color:var(--bad)">&#10005;</span> Rushes, begs, panics</li>
                <li><span style="color:var(--bad)">&#10005;</span> Chases intensity over presence</li>
                <li><span style="color:var(--bad)">&#10005;</span> Confuses familiarity with safety</li>
                <li><span style="color:var(--bad)">&#10005;</span> Feels automatic and overpowering</li>
                <li><span style="color:var(--bad)">&#10005;</span> Compensates for unmet childhood needs</li>
                <li><span style="color:var(--bad)">&#10005;</span> Driven by the child's emotional logic</li>
                <li><span style="color:var(--bad)">&#10005;</span> Connection requires self-betrayal</li>
                <li><span style="color:var(--bad)">&#10005;</span> Calm feels like boredom</li>
              </ul>
            </div>
            <div class="transformDivider">&#8594;</div>
            <div class="transformCol" style="border-color: rgba(117,240,182,.25)">
              <h3 style="color:var(--good)">Integrated Desire (After)</h3>
              <ul>
                <li><span style="color:var(--good)">&#10003;</span> Waits, responds, chooses</li>
                <li><span style="color:var(--good)">&#10003;</span> Responds to what is present</li>
                <li><span style="color:var(--good)">&#10003;</span> Distinguishes pattern from truth</li>
                <li><span style="color:var(--good)">&#10003;</span> Feels grounded and selective</li>
                <li><span style="color:var(--good)">&#10003;</span> Expresses rather than compensates</li>
                <li><span style="color:var(--good)">&#10003;</span> Guided by conscious adult self</li>
                <li><span style="color:var(--good)">&#10003;</span> Intimacy without hunger</li>
                <li><span style="color:var(--good)">&#10003;</span> Peace feels like arrival</li>
              </ul>
            </div>
          </div>

          <div class="hr"></div>

          <div class="viz" aria-label="Transformation visualization">
            <svg viewBox="0 0 980 200" role="img" aria-label="Visual metaphor: tangled threads becoming aligned flow">
              <defs>
                <linearGradient id="tgBad" x1="0" x2="1" y1="0" y2="0">
                  <stop offset="0" stop-color="rgba(255,122,153,.6)" />
                  <stop offset="1" stop-color="rgba(187,167,255,.3)" />
                </linearGradient>
                <linearGradient id="tgGood" x1="0" x2="1" y1="0" y2="0">
                  <stop offset="0" stop-color="rgba(187,167,255,.3)" />
                  <stop offset="1" stop-color="rgba(117,240,182,.6)" />
                </linearGradient>
                <filter id="tgGlow" x="-10%" y="-20%" width="120%" height="140%">
                  <feGaussianBlur stdDeviation="4" result="b"/>
                  <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
                </filter>
              </defs>

              <g filter="url(#tgGlow)">
                <!-- Left: tangled -->
                <text x="120" y="28" font-size="12" fill="rgba(255,122,153,.6)" text-anchor="middle" font-weight="700">COMPULSIVE</text>
                <path d="M30,60 C60,140 80,40 110,120 C140,180 100,60 160,100 C190,120 170,160 210,80" fill="none" stroke="rgba(255,122,153,.45)" stroke-width="3" stroke-linecap="round"/>
                <path d="M40,80 C70,30 90,160 130,70 C160,20 140,150 180,110 C200,90 190,140 220,60" fill="none" stroke="rgba(255,179,138,.35)" stroke-width="2.5" stroke-linecap="round"/>
                <path d="M50,120 C80,60 100,180 140,90 C170,40 150,140 190,130 C210,120 200,80 230,100" fill="none" stroke="rgba(187,167,255,.35)" stroke-width="2" stroke-linecap="round"/>

                <!-- Center: transition -->
                <text x="490" y="28" font-size="12" fill="rgba(255,255,255,.4)" text-anchor="middle" font-weight="700">INTEGRATION</text>
                <path d="M300,100 Q390,80 490,100 Q590,120 680,100" fill="none" stroke="rgba(255,255,255,.15)" stroke-width="2" stroke-dasharray="6 4"/>
                <circle cx="490" cy="100" r="30" fill="none" stroke="rgba(187,167,255,.2)" stroke-width="1.5"/>
                <text x="490" y="104" text-anchor="middle" font-size="11" fill="rgba(187,167,255,.5)">awareness</text>

                <!-- Right: aligned -->
                <text x="860" y="28" font-size="12" fill="rgba(117,240,182,.6)" text-anchor="middle" font-weight="700">INTEGRATED</text>
                <path d="M750,100 C790,85 830,95 870,90 C910,85 940,95 960,100" fill="none" stroke="rgba(117,240,182,.5)" stroke-width="3" stroke-linecap="round"/>
                <path d="M750,110 C790,100 830,108 870,105 C910,102 940,108 960,110" fill="none" stroke="rgba(122,215,255,.35)" stroke-width="2.5" stroke-linecap="round"/>
                <path d="M750,120 C790,115 830,118 870,117 C910,116 940,119 960,120" fill="none" stroke="rgba(187,167,255,.3)" stroke-width="2" stroke-linecap="round"/>
              </g>
            </svg>
            <div class="small">Left: tangled, compulsive patterns. Center: awareness as turning point. Right: aligned, integrated flow.</div>
          </div>

          <div class="callout" data-commentary>
            <b>Commentary:</b> "Individuation is the process of becoming who you actually are instead of who you had to be." (Jung). This transformation is not about becoming desire-free. It is about desire maturing from a childhood survival strategy into an adult capacity for genuine connection.
          </div>
        </div>
      </section>

      <!-- SECTION 8: The Final Question -->
      <section class="card" aria-label="Final reflection">
        <div class="cardHeader">
          <h2>The question that changes everything</h2>
          <div class="chip">individuation begins here</div>
        </div>
        <div class="cardBody">
          <div class="split">
            <div>
              <p class="muted" style="margin-top:0">
                Your childhood shaped your desire, but it does not get to decide your future. Once you see the pattern, you are no longer inside it. And from that moment on, every choice becomes conscious.
              </p>

              <div class="quoteBlock" style="border-color:rgba(117,240,182,.3);background:rgba(117,240,182,.06)">
                <p style="font-size:18px;color:rgba(117,240,182,.95)">Is this desire coming from who I was&mdash;or who I am becoming?</p>
                <div class="qAttr" style="color:var(--good)">&mdash; The pivotal question</div>
              </div>

              <p class="muted">
                This single question separates unconscious repetition from conscious evolution. It does not require an immediate answer. It requires a willingness to stay present with the question itself.
              </p>
            </div>
            <div>
              <div class="viz" aria-label="Two paths">
                <svg viewBox="0 0 440 320" role="img" aria-label="Fork in the road: past self vs future self">
                  <defs>
                    <linearGradient id="pathPast" x1="0" x2="0" y1="0" y2="1">
                      <stop offset="0" stop-color="rgba(255,210,122,.5)" />
                      <stop offset="1" stop-color="rgba(255,122,153,.4)" />
                    </linearGradient>
                    <linearGradient id="pathFuture" x1="0" x2="0" y1="0" y2="1">
                      <stop offset="0" stop-color="rgba(187,167,255,.5)" />
                      <stop offset="1" stop-color="rgba(117,240,182,.5)" />
                    </linearGradient>
                    <filter id="pathGlow" x="-20%" y="-20%" width="140%" height="140%">
                      <feGaussianBlur stdDeviation="5" result="b"/>
                      <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                  </defs>

                  <g filter="url(#pathGlow)">
                    <!-- Starting point -->
                    <circle cx="220" cy="40" r="16" fill="rgba(255,255,255,.12)" stroke="rgba(255,255,255,.35)" stroke-width="1.5"/>
                    <text x="220" y="44" text-anchor="middle" font-size="10" fill="rgba(255,255,255,.8)" font-weight="700">YOU</text>

                    <!-- Fork -->
                    <path d="M220,56 L220,110" stroke="rgba(255,255,255,.2)" stroke-width="2"/>

                    <!-- Decision point -->
                    <circle cx="220" cy="120" r="12" fill="rgba(187,167,255,.15)" stroke="rgba(187,167,255,.4)" stroke-width="1.5"/>
                    <text x="220" y="124" text-anchor="middle" font-size="8" fill="rgba(187,167,255,.9)">?</text>

                    <!-- Left path: Past -->
                    <path d="M208,120 C160,150 110,180 90,250" fill="none" stroke="url(#pathPast)" stroke-width="3" stroke-linecap="round" stroke-dasharray="6 4"/>
                    <circle cx="90" cy="260" r="24" fill="rgba(255,122,153,.10)" stroke="rgba(255,122,153,.35)" stroke-width="1.5"/>
                    <text x="90" y="256" text-anchor="middle" font-size="9" fill="rgba(255,122,153,.9)" font-weight="700">WHO I</text>
                    <text x="90" y="268" text-anchor="middle" font-size="9" fill="rgba(255,122,153,.9)" font-weight="700">WAS</text>
                    <text x="90" y="300" text-anchor="middle" font-size="10" fill="rgba(255,255,255,.45)">repetition</text>

                    <!-- Right path: Future -->
                    <path d="M232,120 C280,150 330,180 350,250" fill="none" stroke="url(#pathFuture)" stroke-width="3" stroke-linecap="round"/>
                    <circle cx="350" cy="260" r="24" fill="rgba(117,240,182,.10)" stroke="rgba(117,240,182,.35)" stroke-width="1.5"/>
                    <text x="350" y="256" text-anchor="middle" font-size="9" fill="rgba(117,240,182,.9)" font-weight="700">WHO I'M</text>
                    <text x="350" y="268" text-anchor="middle" font-size="9" fill="rgba(117,240,182,.9)" font-weight="700">BECOMING</text>
                    <text x="350" y="300" text-anchor="middle" font-size="10" fill="rgba(255,255,255,.45)">individuation</text>
                  </g>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Commentary toggle explainer -->
      <section class="card" aria-label="About commentary mode">
        <div class="cardHeader">
          <h2>About the commentary toggle</h2>
          <div class="chip">interpretation vs. content</div>
        </div>
        <div class="cardBody">
          <p class="muted" style="margin-top:0">
            Throughout this page, purple callout boxes (marked with <code>data-commentary</code>) offer meta-level commentary:
            How well-supported is each claim? What are alternative framings? What nuance is missing?
          </p>
          <p class="muted">
            By default, commentary is <b>visible</b>. Click "Toggle commentary" at the top to hide/show all commentary boxes at once.
            This lets you switch between "what Jung's framework says" and "a critical perspective on those claims."
          </p>

          <details data-commentary>
            <summary><strong>A note on evidence and framing</strong><span class="hint">click to expand</span></summary>
            <div class="detailBody">
              <p>
                This infographic translates a Jungian perspective on desire and childhood. Jung's framework is clinically influential but also contested in modern psychology. Some elements (the role of early attachment in adult relationships) have robust empirical support. Others (specific shadow interpretations of fantasy content) are more theoretical and harder to test. Treat everything here as a <b>lens for self-understanding</b>, not as diagnostic truth. If you recognize patterns that cause distress, consider working with a qualified therapist rather than self-diagnosing.
              </p>
            </div>
          </details>
        </div>
      </section>

    </div>

    <footer>
      <p>
        <b>Credits &amp; disclaimers:</b> This interactive infographic was generated to translate a Jungian psychological perspective on how childhood patterns shape adult sexual desire.
        It is not therapy or medical advice. Visualizations, interactive elements, and commentary are conceptual tools to help you reflect on the ideas presented, not substitutes for professional psychological support.
      </p>
      <p style="margin-top:10px">
        For deeper exploration: consult the works of Carl Jung (especially on shadow, individuation, and the collective unconscious), attachment theory research, and qualified depth psychologists.
      </p>
    </footer>

  </div>

  <div class="toast" id="toast"></div>

  <script>
    // ──────────────────────────────────────────────────────
    // Navigation buttons
    // ──────────────────────────────────────────────────────
    document.getElementById('jumpPatterns').addEventListener('click', () => {
      document.getElementById('patterns').scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
    document.getElementById('jumpIceberg').addEventListener('click', () => {
      document.getElementById('iceberg').scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
    document.getElementById('jumpReflect').addEventListener('click', () => {
      document.getElementById('reflect').scrollIntoView({ behavior: 'smooth', block: 'start' });
    });

    // ──────────────────────────────────────────────────────
    // Commentary toggle
    // ──────────────────────────────────────────────────────
    let commentaryVisible = true;
    document.getElementById('toggleNotes').addEventListener('click', () => {
      commentaryVisible = !commentaryVisible;
      const items = document.querySelectorAll('[data-commentary]');
      items.forEach(el => {
        el.style.display = commentaryVisible ? '' : 'none';
      });
      showToast(commentaryVisible ? 'Commentary visible' : 'Commentary hidden');
    });

    // ──────────────────────────────────────────────────────
    // Pattern cards interaction
    // ──────────────────────────────────────────────────────
    const patternCards = document.querySelectorAll('.patternCard');
    patternCards.forEach(card => {
      card.addEventListener('click', () => {
        const wasActive = card.classList.contains('active');
        patternCards.forEach(c => c.classList.remove('active'));
        if (!wasActive) {
          card.classList.add('active');
        }
      });
    });

    // ──────────────────────────────────────────────────────
    // Awareness slider (repetition loop)
    // ──────────────────────────────────────────────────────
    const awarenessSlider = document.getElementById('awarenessSlider');
    const awarenessReadout = document.getElementById('awarenessReadout');
    const awarenessMsg = document.getElementById('awarenessMsg');
    const loopArc = document.getElementById('loopArc');
    const breakPoint = document.getElementById('breakPoint');
    const breakLabel = document.getElementById('breakLabel');
    const centerLabel = document.getElementById('centerLabel');

    const awarenessLevels = [
      { threshold: 0, label: 'Low', msg: 'The loop runs fully unconscious. You repeat without seeing. Desire feels automatic and overpowering because the child\'s emotional logic is in control.' },
      { threshold: 25, label: 'Emerging', msg: 'You begin to notice: "I\'ve felt this before." Pattern recognition starts, but the pull is still strong. You might see the loop mid-cycle.' },
      { threshold: 50, label: 'Growing', msg: 'You can name the pattern while it happens. "This is familiar, not true." Identification weakens. You are no longer fully inside the desire.' },
      { threshold: 75, label: 'Strong', msg: 'You pause before reacting. You ask "What part of me learned this?" The urge belongs to a memory, not a mandate. Awareness breaks the automaticity.' },
      { threshold: 90, label: 'Integrated', msg: 'Desire loses its compulsive urgency. It becomes quieter, more grounded, more selective. You choose instead of react. Peace replaces intensity as the signal of connection.' }
    ];

    function updateAwareness() {
      const val = parseInt(awarenessSlider.value);
      let level = awarenessLevels[0];
      for (let i = awarenessLevels.length - 1; i >= 0; i--) {
        if (val >= awarenessLevels[i].threshold) {
          level = awarenessLevels[i];
          break;
        }
      }

      awarenessReadout.textContent = level.label;
      awarenessMsg.textContent = level.msg;

      // Animate loop arc - higher awareness = more break in the loop
      const circumference = 2 * Math.PI * 140; // ~880
      const breakGap = (val / 100) * (circumference * 0.6);
      loopArc.setAttribute('stroke-dasharray', `${circumference - breakGap} ${breakGap}`);

      // Reduce pulse animation with awareness
      loopArc.style.animationDuration = val > 70 ? '6s' : '3s';
      if (val > 85) {
        loopArc.style.animation = 'none';
        loopArc.style.opacity = '0.3';
      } else {
        loopArc.style.animation = '';
        loopArc.style.opacity = '';
      }

      // Show break point indicator
      const breakOpacity = Math.min(1, val / 60);
      breakPoint.setAttribute('r', Math.min(14, val / 7));
      breakPoint.setAttribute('opacity', breakOpacity);
      breakLabel.setAttribute('fill', `rgba(117,240,182,${breakOpacity})`);

      // Change center label
      if (val > 70) {
        centerLabel.textContent = 'AWARENESS';
        centerLabel.setAttribute('fill', 'rgba(117,240,182,.6)');
      } else if (val > 40) {
        centerLabel.textContent = 'RECOGNIZING';
        centerLabel.setAttribute('fill', 'rgba(187,167,255,.5)');
      } else {
        centerLabel.textContent = 'COMPULSION';
        centerLabel.setAttribute('fill', 'rgba(255,255,255,.5)');
      }
    }

    awarenessSlider.addEventListener('input', updateAwareness);
    updateAwareness();

    // ──────────────────────────────────────────────────────
    // Emotion selector (self-reflection tool)
    // ──────────────────────────────────────────────────────
    const emotionInsights = {
      loneliness: {
        title: 'Loneliness as desire trigger',
        text: 'When loneliness precedes desire, your psyche may be using attraction as a shortcut to connection. The younger self who learned that closeness was unreliable now urgently seeks proof of being wanted. The question becomes: can you tolerate being alone without reaching for intensity?',
        color: 'var(--cyan)'
      },
      tension: {
        title: 'Tension as desire trigger',
        text: 'When tension precedes desire, your nervous system may have learned that arousal is the fastest way to discharge stress. If your childhood environment was tense, your body learned to associate heightened states with the proximity of connection. The question: what would it mean to release tension without merging it with desire?',
        color: 'var(--orange)'
      },
      restlessness: {
        title: 'Restlessness as desire trigger',
        text: 'Restlessness before desire suggests your psyche is seeking regulation. The child who had to be hypervigilant may have learned that desire provides a focused channel for scattered energy. The question: what is the restlessness actually about, before desire gives it a target?',
        color: 'var(--warn)'
      },
      invisibility: {
        title: 'Invisibility as desire trigger',
        text: 'When feeling unseen precedes desire, your psyche may equate being desired with being real. The child who felt invisible learned that sexual attention is the most potent proof of existence. The question: can you feel present and valid without someone else\'s desire confirming you?',
        color: 'var(--violet)'
      },
      powerlessness: {
        title: 'Powerlessness as desire trigger',
        text: 'Powerlessness before desire often leads to fantasies of control, or conversely, a desire to surrender completely. The child who felt powerless learned that desire is one domain where agency can be exercised or safely relinquished. The question: what would genuine empowerment look like outside of desire?',
        color: 'var(--bad)'
      },
      boredom: {
        title: 'Boredom as desire trigger',
        text: 'Boredom preceding desire suggests your nervous system was calibrated for intensity. If your childhood was chaotic, calm feels threatening - like something bad is about to happen. Desire provides the intensity your system expects. The question: can you learn to tolerate peace without interpreting it as emptiness?',
        color: 'var(--faint)'
      },
      anxiety: {
        title: 'Anxiety as desire trigger',
        text: 'When anxiety precedes desire, your body may be confusing arousal states. The physiological signatures of anxiety and desire overlap significantly. If love came with worry in childhood, your nervous system fused them. The question: can you distinguish between wanting someone and being afraid of losing them?',
        color: 'var(--bad)'
      },
      emptiness: {
        title: 'Emptiness as desire trigger',
        text: 'Emptiness before desire reveals the compensatory function of attraction. The child whose emotional needs were unmet experiences a void that desire promises to fill. But desire cannot fill what was never given - only acknowledged. The question: can you sit with the emptiness long enough to hear what it actually needs?',
        color: 'var(--muted)'
      }
    };

    const emotionBtns = document.querySelectorAll('.emotionBtn');
    const emotionInsightDiv = document.getElementById('emotionInsight');

    emotionBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        emotionBtns.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');

        const emotion = btn.dataset.emotion;
        const insight = emotionInsights[emotion];

        emotionInsightDiv.innerHTML = `
          <div class="flowNode fadeIn" style="border-color: ${insight.color === 'var(--faint)' || insight.color === 'var(--muted)' ? 'rgba(255,255,255,.2)' : insight.color.replace(')', ',.3)').replace('var(--', 'rgba(').replace(')', '')}">
            <h3 style="color:${insight.color}">${insight.title}</h3>
            <p>${insight.text}</p>
          </div>
        `;

        showToast('Reflection unlocked');
      });
    });

    // ──────────────────────────────────────────────────────
    // Integration checklist scoring
    // ──────────────────────────────────────────────────────
    document.getElementById('intScoreBtn').addEventListener('click', () => {
      const checkboxes = document.querySelectorAll('#integrationChecklist input[type="checkbox"]');
      const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
      const total = checkboxes.length;
      const pct = Math.round((checked / total) * 100);

      let msg = '';
      if (pct >= 85) msg = `${pct}% - Deep integration work. You are building a conscious relationship with your desire patterns.`;
      else if (pct >= 60) msg = `${pct}% - Strong foundation. The patterns are becoming visible. Keep practicing non-judgmental observation.`;
      else if (pct >= 40) msg = `${pct}% - Emerging awareness. You are beginning to see the map. Focus on step 2: observing without judgment.`;
      else msg = `${pct}% - Early stages. Start with recognition: "What part of me learned to want this?" That single question opens the door.`;

      document.getElementById('intScoreOut').innerHTML = `<b>Integration progress:</b> ${msg}`;
      showToast('Progress assessed');
    });

    document.getElementById('intResetBtn').addEventListener('click', () => {
      const checkboxes = document.querySelectorAll('#integrationChecklist input[type="checkbox"]');
      checkboxes.forEach(cb => cb.checked = false);
      document.getElementById('intScoreOut').innerHTML = '';
      showToast('Checklist reset');
    });

    // ──────────────────────────────────────────────────────
    // Toast notification
    // ──────────────────────────────────────────────────────
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.style.display = 'block';
      setTimeout(() => {
        toast.style.display = 'none';
      }, 2000);
    }
  </script>
</body>
</html>
